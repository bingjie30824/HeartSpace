diff --git a/HeartSpace/Content/Site.css b/HeartSpace/Content/Site.css
index 0ffae6d..40482d7 100644
--- a/HeartSpace/Content/Site.css
+++ b/HeartSpace/Content/Site.css
@@ -18,3 +18,4 @@ select,
 textarea {
     max-width: 280px;
 }
+
diff --git a/HeartSpace/Controllers/EventController.cs b/HeartSpace/Controllers/EventController.cs
index d226acf..02f7c42 100644
--- a/HeartSpace/Controllers/EventController.cs
+++ b/HeartSpace/Controllers/EventController.cs
@@ -88,26 +88,161 @@ namespace HeartSpace.Controllers
 			// 設置是否已報名此活動
 			model.IsRegistered = _eventService.IsMemberRegistered(id, currentMemberId);
 
-
-			// 加載評論
+			// 加載評論，並判斷是否為留言者本人
 			model.Comments = _eventService.GetEventComments(id)
 				.Select(c => new CommentViewModel
 				{
 					Id = c.Id,
 					MemberId = c.MemberId,
-					MemberName = c.Member?.Name ?? "未知用戶", // 預設名稱
-					MemberNickName = c.Member?.NickName ?? "未知用戶", // 預設名稱
+					MemberName = c.Member?.Name ?? "未知用戶", 
+					MemberNickName = c.Member?.NickName ?? "未知用戶", 
 					MemberProfileImg = c.Member?.MemberImg,
 					EventCommentContent = c.EventCommentContent,
-					CommentTime = c.CommentTime
+					CommentTime = c.CommentTime,
+					IsCommentOwner = _eventService.IsCommentOwner(c.Id, currentMemberId)  
 				})
 				.ToList();
+
 			// 加載當前參與人數
-			model.ParticipantNow = _eventService.GetParticipantCount(id); 
+			model.ParticipantNow = _eventService.GetParticipantCount(id);
+
+			// 加載活動報名人數上限
+			model.ParticipantMax = model.ParticipantMax; // 確保 ParticipantMax 已從服務層載入
+
+			// 檢查是否已達報名上限
+			model.IsFull = model.ParticipantNow >= model.ParticipantMax;
 
 			return View(model);
 		}
 
+		[HttpPost]
+		[ValidateAntiForgeryToken]
+		public ActionResult DeleteComment(int commentId, int eventId)
+		{
+			try
+			{
+				// 根據活動 ID 獲取留言
+				var comment = _eventService.GetEventComments(eventId)
+					.FirstOrDefault(c => c.Id == commentId);
+
+				if (comment == null)
+				{
+					return HttpNotFound("找不到該留言。");
+				}
+
+				// 確認當前用戶是否有權刪除該留言
+				int currentMemberId = GetCurrentMemberId(); // 假設有此方法
+				if (!_eventService.IsCommentOwner(commentId, currentMemberId))
+				{
+					return new HttpStatusCodeResult(403, "無權刪除此留言。");
+				}
+
+				// 執行刪除操作
+				_eventService.RemoveComment(comment);
+
+				// 刪除成功後返回活動詳情頁
+				return RedirectToAction("EventDetail", new { id = eventId });
+			}
+			catch (Exception ex)
+			{
+				// 返回錯誤訊息
+				return new HttpStatusCodeResult(500, $"刪除留言時發生錯誤：{ex.Message}");
+			}
+		}
+
+		public ActionResult EditComment(int commentId)
+		{
+			// 查詢留言
+			var comment = _eventService.GetEventComments(commentId) // 請傳入正確的活動 ID
+				.FirstOrDefault(c => c.Id == commentId);
+
+			if (comment == null)
+			{
+				return HttpNotFound("找不到該留言。");
+			}
+
+			// 確認當前用戶是否為留言所有者
+			int currentMemberId = GetCurrentMemberId(); // 假設有此方法
+			if (!_eventService.IsCommentOwner(commentId, currentMemberId))
+			{
+				return new HttpStatusCodeResult(403, "無權編輯此留言。");
+			}
+
+			// 返回編輯視圖，傳遞現有資料
+			return View(comment);
+		}
+
+		[HttpPost]
+		[ValidateAntiForgeryToken]
+		public ActionResult EditComment(int commentId, string updatedContent, int eventId)
+		{
+			try
+			{
+				// 使用傳入的活動 ID 獲取留言
+				var comment = _eventService.GetEventComments(eventId)
+							.FirstOrDefault(c => c.Id == commentId);
+
+				if (comment == null)
+				{
+					return HttpNotFound("找不到該留言。");
+				}
+
+				// 確認當前用戶是否為留言所有者
+				int currentMemberId = GetCurrentMemberId();
+				if (!_eventService.IsCommentOwner(commentId, currentMemberId))
+				{
+					return new HttpStatusCodeResult(403, "無權編輯此留言。");
+				}
+
+				// 更新留言內容
+				comment.EventCommentContent = updatedContent;
+				_eventService.UpdateComment(comment); // 假設有 UpdateComment 方法
+
+				// 返回活動詳情頁
+				return RedirectToAction("EventDetail", new { id = comment.EventId });
+			}
+			catch (Exception ex)
+			{
+				return new HttpStatusCodeResult(500, $"編輯時發生錯誤：{ex.Message}");
+			}
+		}
+
+		[HttpPost]
+		[ValidateAntiForgeryToken]
+		public ActionResult AddComment(int eventId, string commentContent)
+		{
+			try
+			{
+				// 驗證留言內容是否有效
+				if (string.IsNullOrWhiteSpace(commentContent))
+				{
+					return new HttpStatusCodeResult(400, "留言內容不得為空。");
+				}
+
+				// 獲取當前用戶 ID
+				int currentMemberId = GetCurrentMemberId(); // 假設有這個方法
+
+				// 建立新的留言物件
+				var newComment = new EventComment
+				{
+					EventId = eventId,
+					MemberId = currentMemberId,
+					EventCommentContent = commentContent,
+					CommentTime = DateTime.Now
+				};
+
+				// 呼叫服務層新增留言
+				_eventService.AddComment(newComment);
+
+				// 新增成功後重導回活動詳情頁
+				return RedirectToAction("EventDetail", new { id = eventId });
+			}
+			catch (Exception ex)
+			{
+				// 返回錯誤訊息
+				return new HttpStatusCodeResult(500, $"新增留言時發生錯誤：{ex.Message}");
+			}
+		}
 
 		[HttpPost]
 		public ActionResult ToggleRegistration(int eventId, string actionType)
@@ -132,5 +267,6 @@ namespace HeartSpace.Controllers
 		{
 			return 3; // 測試用固定 MemberId
 		}
+
 	}
 }
diff --git a/HeartSpace/Controllers/PostController.cs b/HeartSpace/Controllers/PostController.cs
index caa671d..3a3a64a 100644
--- a/HeartSpace/Controllers/PostController.cs
+++ b/HeartSpace/Controllers/PostController.cs
@@ -1,7 +1,9 @@
-﻿using HeartSpace.Models.DTOs;
+﻿using HeartSpace.Models;
+using HeartSpace.Models.DTOs;
 using HeartSpace.Models.EFModels;
 using HeartSpace.Models.Services;
 using System;
+using System.Collections.Generic;
 using System.Linq;
 using System.Web;
 using System.Web.Mvc;
@@ -111,6 +113,17 @@ namespace HeartSpace.Controllers
 					model.PostImg = Image.ToBase64String();
 				}
 
+            // 將 PostViewModel 轉換為 CreatePostDto
+            var dto = new CreatePostDto
+            {
+                Id = model.Id,
+                Title = model.Title,
+                PostContent = model.PostContent,
+                PostImg = model.PostImg,
+                CategoryId = model.CategoryId,
+                PublishTime = model.PublishTime,
+                MemberId = model.MemberId,
+            };
 
 				// 呼叫 Service 更新貼文
 				_postService.UpdatePost(model);
diff --git a/HeartSpace/DTOs/EventService.cs b/HeartSpace/DTOs/EventService.cs
index abff5f0..59c560d 100644
--- a/HeartSpace/DTOs/EventService.cs
+++ b/HeartSpace/DTOs/EventService.cs
@@ -145,5 +145,45 @@ namespace HeartSpace.BLL
 			}
 		}
 
+		// 檢查是否為留言者本人
+		public bool IsCommentOwner(int commentId, int memberId)
+		{
+			using (var context = new AppDbContext())
+			{
+				// 從資料庫中查詢指定的留言
+				var comment = context.EventComments.FirstOrDefault(c => c.Id == commentId);
+
+				// 如果留言不存在，返回 false
+				if (comment == null)
+				{
+					return false;
+				}
+
+				// 判斷該留言的 MemberId 是否等於當前用戶的 MemberId
+				return comment.MemberId == memberId;
+			}
+		}
+
+		public void UpdateComment(EventComment updatedComment)
+		{
+			using (var context = new AppDbContext())
+			{
+				// 查找需要更新的留言
+				var existingComment = context.EventComments.FirstOrDefault(c => c.Id == updatedComment.Id);
+				if (existingComment != null)
+				{
+					// 更新內容
+					existingComment.EventCommentContent = updatedComment.EventCommentContent;
+
+					// 保存更改
+					context.SaveChanges();
+				}
+				else
+				{
+					throw new Exception("找不到該留言，無法更新。");
+				}
+			}
+		}
+
 	}
 }
diff --git a/HeartSpace/Models/DTOs/CreatePostDto.cs b/HeartSpace/Models/DTOs/CreatePostDto.cs
index ee04adc..d465dc0 100644
--- a/HeartSpace/Models/DTOs/CreatePostDto.cs
+++ b/HeartSpace/Models/DTOs/CreatePostDto.cs
@@ -13,6 +13,7 @@ namespace HeartSpace.Models.DTOs
         public string PostImg { get; set; } // 圖片的 Base64 編碼
         public int CategoryId { get; set; }
         public int MemberId { get; set; }
+        public string MemberImg { get; set; }
         public string CategoryName { get; set; }
         public string Comments { get; set; }
 
diff --git a/HeartSpace/Models/PostViewModel.cs b/HeartSpace/Models/PostViewModel.cs
index d72364a..af9d854 100644
--- a/HeartSpace/Models/PostViewModel.cs
+++ b/HeartSpace/Models/PostViewModel.cs
@@ -36,19 +36,15 @@ namespace HeartSpace.Models
     }
     public class CommentViewModel
     {
-        public int CommentId { get; set; } // 留言 ID
 
-
-
-        public string Content { get; set; } // 留言內容
-
-        public string AuthorName { get; set; } // 留言者名稱
-
-        public int AuthorId { get; set; } // 留言 ID
-
-        public string AuthorImg { get; set; } // 留言者頭像 Base64 格式
-
-        public DateTime CreatedAt { get; set; } // 留言時間
+        public int PostId { get; set; }
+        public int CommentId { get; set; }
+        public int UserId { get; set; }
+        public string UserName { get; set; }
+        public string UserImg { get; set; }
+        public string Comment { get; set; }
+        public DateTime CommentTime { get; set; }
+        public int FloorNumber { get; set; } // 新增：樓層編號
     }
 
 
diff --git a/HeartSpace/Models/ViewModels/EventViewModel.cs b/HeartSpace/Models/ViewModels/EventViewModel.cs
index 95d3bff..33aad47 100644
--- a/HeartSpace/Models/ViewModels/EventViewModel.cs
+++ b/HeartSpace/Models/ViewModels/EventViewModel.cs
@@ -69,6 +69,8 @@ namespace HeartSpace.Models.ViewModels
 
 		public bool IsRegistered { get; set; } // 是否已報名
 
+		public bool IsFull { get; set; } //報名是否已滿
+
 		// 活動是否已關閉
 		[Display(Name = "是否已關閉")]
 		public bool Disabled { get; set; }
@@ -121,6 +123,7 @@ namespace HeartSpace.Models.ViewModels
 		public byte[] MemberProfileImg { get; set; }
 		public string EventCommentContent { get; set; }
 		public DateTime CommentTime { get; set; }
+		public bool IsCommentOwner { get; set; }
 	}
 
 
diff --git a/HeartSpace/Views/Event/EventDetail.cshtml b/HeartSpace/Views/Event/EventDetail.cshtml
index b1880e4..312d3ca 100644
--- a/HeartSpace/Views/Event/EventDetail.cshtml
+++ b/HeartSpace/Views/Event/EventDetail.cshtml
@@ -1,4 +1,7 @@
 ﻿@model HeartSpace.Models.ViewModels.EventViewModel
+<!-- 隱藏的活動 ID，用於編輯或刪除操作 -->
+
+
 <div class="container mt-5" style="max-width: 70%; margin: 0 auto;">
 
     <!-- 照片 -->
@@ -27,8 +30,8 @@
             <h1 style="margin: 0; font-size: 2rem; font-weight: bold; color: #333;">@Model.EventName</h1>
         </div>
         <!-- 發起人資訊 -->
-        <div class="d-flex align-items-center">
-            <div class="me-3">
+        <div class="d-flex flex-column align-items-center">
+            <div class="mb-1">
                 @if (Model.MemberProfileImg != null)
                 {
                     <img src="data:image/png;base64,@Convert.ToBase64String(Model.MemberProfileImg)"
@@ -36,18 +39,16 @@
                 }
                 else
                 {
-                    <i class="fa-regular fa-circle-user" style="font-size: 40px; color: #ccc;"></i>
-
+                    <i class="fa-regular fa-circle-user" style="font-size: 50px; color: #ccc;"></i>
                 }
-
-
             </div>
             <div>
-                <p class="mb-0" style="font-size: 1.2rem; font-weight: bold; color: #555;">@Model.MemberNickName</p>
+                <p class="mb-0" style="font-size: 1.1rem; font-weight: bold; color: #555;">@Model.MemberNickName</p>
             </div>
         </div>
     </div>
 
+
     <!-- 類別、線上線下、時間 -->
     <div class="d-flex justify-content-start align-items-center text-muted mb-4" style="font-size: 1.1rem;">
         <div class="d-flex align-items-center me-4">
@@ -100,6 +101,15 @@
                 取消報名
             </button>
         }
+        else if (Model.IsFull)
+        {
+            <!-- 報名已滿 -->
+            <button class="btn w-100 py-2"
+                    style="font-size: 1.2rem; color: gray; background-color: #e6e6e6; border: none; border-radius: 8px;"
+                    disabled>
+                報名人數已滿
+            </button>
+        }
         else
         {
             <!-- 報名活動按鈕 -->
@@ -238,6 +248,7 @@
         </div>
 
         <!-- 留言顯示區 -->
+        <input type="hidden" id="eventId" value="@Model.Id" />
         <div class="comments">
             @foreach (var comment in Model.Comments)
             {
@@ -252,43 +263,134 @@
                     else
                     {
                         <i class="fa-regular fa-circle-user me-3"
-                           style="font-size: 40px; color: #ccc;"></i>
+                           style="font-size: 50px; color: #ccc;"></i>
                     }
 
-
-
-                    <div>
+                    <div class="flex-grow-1">
                         <!-- 留言者姓名 -->
                         <p class="mb-1"><strong>@comment.MemberNickName</strong></p>
                         <!-- 留言內容 -->
                         <p class="mb-1">@comment.EventCommentContent</p>
-                        <!-- 留言時間與刪除按鈕 -->
-                        <div class="d-flex align-items-center">
-                            <small class="text-muted">@comment.CommentTime.ToString("MM/dd HH:mm")</small>
-                            @if (comment.MemberId == Model.CurrentMemberId)
-                            {
-                                <form action="@Url.Action("DeleteComment", "Event")" method="post" class="ms-2">
-                                    @Html.AntiForgeryToken()
-                                    <input type="hidden" name="commentId" value="@comment.Id" />
-                                    <button type="submit" class="btn btn-link text-danger p-0"
-                                            style="text-decoration: none; font-size: 0.9rem;"
-                                            onclick="return confirm('是否確認刪除此留言？');">
-                                        刪除留言
+                        <!-- 留言時間 -->
+                        <small class="text-muted">@comment.CommentTime.ToString("MM/dd HH:mm")</small>
+                    </div>
+
+                    <!-- 如果是留言者本人，顯示編輯與刪除選單 -->
+                    @if (comment.IsCommentOwner)
+                    {
+                        <div class="dropdown">
+                            <button class="btn dropdown-toggle-custom" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
+                                <i class="fa-solid fa-pen-to-square"></i>
+                            </button>
+
+                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownMenuButton">
+                                <li>
+                                    <button type="button" class="dropdown-item" data-bs-toggle="modal" data-bs-target="#editCommentModal"
+                                            onclick="loadCommentData(@comment.Id, '@comment.EventCommentContent')">
+                                        編輯留言
                                     </button>
-                                </form>
-                            }
+                                </li>
+                                <li>
+                                    <form id="deleteForm" action="@Url.Action("DeleteComment", "Event")" method="post">
+                                        @Html.AntiForgeryToken()
+                                        <input type="hidden" name="commentId" id="deleteCommentId" />
+                                        <input type="hidden" name="eventId" value="@Model.Id" />
+                                        <button type="button" class="dropdown-item text-danger" onclick="openDeleteModal(@comment.Id)">刪除留言</button>
+                                    </form>
+
+                                </li>
+
+                            </ul>
                         </div>
-                    </div>
 
+
+
+                    }
                 </div>
             }
         </div>
+
+        <!-- 編輯留言模態框 -->
+        <div class="modal fade" id="editCommentModal" tabindex="-1" aria-labelledby="editCommentModalLabel" aria-hidden="true">
+            <div class="modal-dialog">
+                <div class="modal-content">
+                    <!-- 表單開始 -->
+                    <form action="@Url.Action("EditComment", "Event")" method="post">
+                        @Html.AntiForgeryToken()
+                        <input type="hidden" id="editCommentId" name="commentId" />
+                        <input type="hidden" id="eventId" name="eventId" value="@Model.Id" />
+                        <div class="modal-header">
+                            <h5 class="modal-title fw-bold" id="editCommentModalLabel">編輯我的留言</h5>
+                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
+                        </div>
+                        <div class="modal-body">
+                            <textarea class="form-control" id="editCommentContent" name="updatedContent" rows="4" required></textarea>
+                        </div>
+                        <div class="modal-footer justify-content-end">
+                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
+                            <button type="submit" class="btn btn-primary" style="background-color: #FDD9A0; border: none; color: black">儲存</button>
+                        </div>
+                    </form>
+                    <!-- 表單結束 -->
+                </div>
+            </div>
+        </div>
+
+        <!-- 刪除確認模態框 -->
+        <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
+            <div class="modal-dialog">
+                <div class="modal-content">
+                    <div class="modal-header">
+                        <h5 class="modal-title fw-bold" id="deleteModalLabel" >HeartSpace心聚點</h5>
+                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
+                    </div>
+                    <div class="modal-body">
+                        是否確認刪除此留言？
+                    </div>
+                    <div class="modal-footer">
+                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
+                        <button type="button" class="btn btn-danger" id="confirmDeleteButton">刪除</button>
+                    </div>
+                </div>
+            </div>
+        </div>
     </div>
 </div>
 
 
 @section Scripts {
     <script>
+        //刪除留言
+        function openDeleteModal(commentId) {
+            // 設置模態框中的隱藏字段值
+            document.getElementById('deleteCommentId').value = commentId;
+
+            // 顯示刪除確認模態框
+            var deleteModal = new bootstrap.Modal(document.getElementById('deleteModal'));
+            deleteModal.show();
+
+            // 綁定刪除按鈕的行為
+            document.getElementById('confirmDeleteButton').onclick = function () {
+                document.getElementById('deleteForm').submit();
+            };
+        }
+        //編輯留言
+        function openEditModal(commentId, commentContent) {
+            document.getElementById('editCommentId').value = commentId;
+            document.getElementById('editCommentContent').value = commentContent;
+            new bootstrap.Modal(document.getElementById('editCommentModal')).show();
+        }
+
+        function confirmDelete() {
+            return confirm("是否確認刪除此留言？");
+        }
+
+        function loadCommentData(commentId, content) {
+            // 將留言的 ID 和內容填充到模態框中
+            document.getElementById('editCommentId').value = commentId;
+            document.getElementById('editCommentContent').value = content;
+        }
+
         document.addEventListener("DOMContentLoaded", function () {
             const commentBox = document.getElementById("commentContent");
             const submitButton = document.getElementById("submitComment");
@@ -315,3 +417,13 @@
 }
 
 
+<style>
+    #dropdownMenuButton {
+        color: #555; /* 修改按鈕顏色 */
+        font-size: 1.3rem;
+    }
+
+    .dropdown-toggle-custom i:hover {
+        color: #fcb874; /* 懸停時顏色 */ 
+</style>
+
diff --git a/HeartSpace/Views/Home/Index.cshtml b/HeartSpace/Views/Home/Index.cshtml
index 17c4b0f..c168077 100644
--- a/HeartSpace/Views/Home/Index.cshtml
+++ b/HeartSpace/Views/Home/Index.cshtml
@@ -52,31 +52,32 @@
                         </div>
                     </div>
 
-                    <!-- 分頁導航 -->
+                    <!-- 貼文版分頁導航 -->
                     <nav>
                         <ul class="pagination justify-content-center mt-3">
                             @if (Model.Posts.HasPreviousPage)
                             {
                                 <li class="page-item">
-                                    <a class="page-link" href="@Url.Action("Index", new { postPage = Model.Posts.PageIndex - 1 })">Previous</a>
+                                    <a class="page-link" href="@Url.Action("Index", new { postPage = Model.Posts.PageIndex - 1, eventPage = Model.Events.PageIndex })">Previous</a>
                                 </li>
                             }
 
                             @for (int i = 1; i <= Model.Posts.TotalPages; i++)
                             {
                                 <li class="page-item @(i == Model.Posts.PageIndex ? "active" : "")">
-                                    <a class="page-link" href="@Url.Action("Index", new { postPage = i })">@i</a>
+                                    <a class="page-link" href="@Url.Action("Index", new { postPage = i, eventPage = Model.Events.PageIndex })">@i</a>
                                 </li>
                             }
 
                             @if (Model.Posts.HasNextPage)
                             {
                                 <li class="page-item">
-                                    <a class="page-link" href="@Url.Action("Index", new { postPage = Model.Posts.PageIndex + 1 })">Next</a>
+                                    <a class="page-link" href="@Url.Action("Index", new { postPage = Model.Posts.PageIndex + 1, eventPage = Model.Events.PageIndex })">Next</a>
                                 </li>
                             }
                         </ul>
                     </nav>
+
                 </div>
             </div>
         </div>
@@ -120,35 +121,33 @@
 
 
 
-                    <!-- 分頁導航 -->
+                    <!-- 揪團版分頁導航 -->
                     <nav>
                         <ul class="pagination justify-content-center mt-3">
-                            <!-- Previous Page -->
-                            @if (Model.Posts.HasPreviousPage)
+                            @if (Model.Events.HasPreviousPage)
                             {
                                 <li class="page-item">
-                                    <a class="page-link" href="@Url.Action("Index", new { postPage = Model.Posts.PageIndex - 1, eventPage = 1 })">Previous</a>
+                                    <a class="page-link" href="@Url.Action("Index", new { postPage = Model.Posts.PageIndex, eventPage = Model.Events.PageIndex - 1 })">Previous</a>
                                 </li>
                             }
 
-                            <!-- Page Numbers -->
-                            @for (int i = 1; i <= Model.Posts.TotalPages; i++)
+                            @for (int i = 1; i <= Model.Events.TotalPages; i++)
                             {
-                                <li class="page-item @(Model.Posts.PageIndex == i ? "active" : "")">
-                                    <a class="page-link" href="@Url.Action("Index", new { postPage = i, eventPage = 1 })">@i</a>
+                                <li class="page-item @(i == Model.Events.PageIndex ? "active" : "")">
+                                    <a class="page-link" href="@Url.Action("Index", new { postPage = Model.Posts.PageIndex, eventPage = i })">@i</a>
                                 </li>
                             }
 
-                            <!-- Next Page -->
-                            @if (Model.Posts.HasNextPage)
+                            @if (Model.Events.HasNextPage)
                             {
                                 <li class="page-item">
-                                    <a class="page-link" href="@Url.Action("Index", new { postPage = Model.Posts.PageIndex + 1, eventPage = 1 })">Next</a>
+                                    <a class="page-link" href="@Url.Action("Index", new { postPage = Model.Posts.PageIndex, eventPage = Model.Events.PageIndex + 1 })">Next</a>
                                 </li>
                             }
                         </ul>
                     </nav>
 
+
                 </div>
             </div>
         </div>
diff --git a/HeartSpace/Views/Post/EditPost.cshtml b/HeartSpace/Views/Post/EditPost.cshtml
index 7e0d068..129f943 100644
--- a/HeartSpace/Views/Post/EditPost.cshtml
+++ b/HeartSpace/Views/Post/EditPost.cshtml
@@ -1,5 +1,6 @@
 ﻿@model HeartSpace.Models.PostViewModel
 
+
 @{
     ViewBag.Title = "修改貼文";
 }
@@ -19,9 +20,9 @@
     <div class="form-section">
         <label for="CategoryId" class="form-label">分類：</label>
         @Html.DropDownListFor(m => m.CategoryId,
-                              Model.CategoryList,
-                              "請選擇分類",
-                              new { @class = "form-control" })
+                                   Model.CategoryList,
+                                   "請選擇分類",
+                                   new { @class = "form-control" })
         @Html.ValidationMessageFor(m => m.CategoryId, "", new { @class = "text-danger" })
     </div>
 
@@ -32,16 +33,6 @@
         }
         @*<p>@Model.PostContent</p>*@
     </div>
-    <div class="form-section">
-        <label for="PostImg" class="form-label">目前圖片：</label>
-        @if (!string.IsNullOrEmpty(Model.PostImg))
-        {
-            <div>
-                <img src="data:image/png;base64,@Model.PostImg" alt="目前圖片" style="max-width: 100%; height: auto; border-radius: 5px;" />
-            </div>
-        }
-    </div>
-
 
     <div class="form-section">
         <label for="Image" class="form-label">更新圖片：</label>
diff --git a/HeartSpace/Views/Post/PostDetails.cshtml b/HeartSpace/Views/Post/PostDetails.cshtml
index 90f2491..60ba28b 100644
--- a/HeartSpace/Views/Post/PostDetails.cshtml
+++ b/HeartSpace/Views/Post/PostDetails.cshtml
@@ -1,4 +1,5 @@
 ﻿@model HeartSpace.Models.PostViewModel
+@using System.Text.RegularExpressions;
 
 <div class="container" style="margin-top: 20px;">
     <!-- 貼文內容 -->
@@ -16,9 +17,17 @@
                 </h2>
             </div>
             <div style="display: flex; align-items: center;">
-                <img src="data:image/png;base64,@Model.MemberImg" alt="原PO頭像" style="width: 50px; height: 50px; border-radius: 50%; margin-right: 10px;">
+                <img src="data:image/png;base64,@(Model.MemberImg ?? "data:image/jpeg;base64,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ICAgICAgICAgICC3sbFQyyxTyjqOJnYGfsv0tQkY+loLVp95BsyAgICAgICAgICAgICAgICD4MGfmdBj7FB25252+1kFogICAgICAgICAgICD7ihd+pv8mQZGtSYefrdBdICAgICAgICAgICAgICAgICAgIKE9Ri/T60FlLQJurn/wC6C2dsv8kHiAgICAgICCpHA79Tf5ILuHDfW/7PMgvBHLqQfaAgICAgICAgICAgICAgICAgICAgICD4ONn62z/YgoFh4/o/Q6CkWGep/wCLIPj5sf1sgfNj+tviQethj+v7EFQcMbzu7/YgrR1Bbzf4oK6AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDAbb7XxUKti7OxvDVhksStGIkbxgOp2FiMA8RmID2iIREiQRFtHv/AJq9qpK9K+VOTZ/G8Ss04gwWWxE9W9SDlskwYidUoooJZzEKl6XijMGmOUtAiG4f+u9Qhc4orM2eLBg0QxjVF5rp4c1+IonmuQgMUsRiAnMcRcQukID00GgbDfKct2fmQp8KsQxYlhGIYnbm14O0UUNfkLldi/38c41IRulJIEsRWtJVtMJEMoiF7s98svCbcUslYbFgo5sJhCGueD2JpvnC1yWiYDWxaYINcvQKvfOrPFqEjhASzQZPab5RmitjMlfD7jz4Rh1m1OMxYPoC7HTCyVWUQxnlP9nGUTkmAOBKENnk81kmDWF5L8omGJh5RQxCJ469GxixaMMOPDI7UpR1ivnDi02ppeGVnTh/LCigcJJeFmgwW8D5RghWG3CNinSixvCas2J2Qw8KU9Fsaio4nwSkszWY49PHDlFmvX1AJSQkXQJBJBb0K4YeWKzR2IKwwSWmGWLKwVb8iY1gOSTVbHQcdc9M3loROOKTUAhrmKb+xhYRkwvFWsPXt3JqjR4SdiDDK5RtLdlePFzpFGRTCIQ17EtmQhmEYSKExELB/lP1CkaOvSxG2J2woVJa8WH8K1iJ4cGJx1axWMTrGxHSkK7xrIQwCMMwlIJMAmG4U97dEqVTEikOKtdLD467nFNr5TcmCCtXlijCUwk40gwF6AFq1FpbUgxm+jbq9QCpLUggkjkxXBKd6Wc5GaKrcxenh+UEEek5Zz5cRgRGEUXBMi19GKQMXtptHjEGIUa8FnDZYrtwyaoWFYg1mPB6wNJiNiTEm2k5MxBqhpxy/N+nj3qQlHp1kg1bFd72N12vxSw0prMFHB7Tcgo4xcGhau32rlSuVoLZ3MSKtARYnrp8jlOKEy4EQzREQfONfKV5PVps1mG7ctWbYzTQYJtBFDRw+nKLYlaxDBRsX8ZgKoMkdXhWJotU88JFwIwlIAzlbfHNJirVms1oKByUY6DyYNjUrYlx8PC4x0doRxCHAAc+Lojr8KeUuTz9HuhrmzHyl5I6lu5iUgPNFXqTQYRFgePYdiIz2Z3hpVRLEb03zkViUo6XKKNSKIZOIWrT2Qq4p8qMYqlHI45cQsyzDfeLDMfOHDYahAWLWLuGcH58jGmM0NUeUhX4stitIXAi4rxB9/7SJlicdWOWgUMuK0sPr0mGwWJWaNnDwuDj1acbfJuRgMkh5ckMCirzFykT8kIdDoCAgICAgICAgICAgIMbjeGvNFJEM0sDmBCM0LwtLG7+nHxYZoNQeqWIx9YkgjnBfk60oAcBmtG54fj2HSmRUxIwxa4Fu/Y4cVGGrHLxYh4Y14ooAEj8iSCnh3yc6sU8UwWr7Rw3KWIhU4tPkr4lXoBQG0bcha0RTQRAEkXKOFqzMY4yLUg+sF+TvWgDD4xt3jDDor9OsMhYaTHg9oYBlwmx/uwddbTSrMJjoteT6Vg9Z6gusL3FxBDFWkv4jYgr2sGs0o7EtEmrDhtkLFSvGUeHQzSRuUcYSS2znnMBDy3NqQVNodxda5PantWLczWcNxPCWhIqYR16N4AC4FaSKkF0tfCFxG3YnCItZAIakGPu/J1glfyt7EZBkgo18TB5MNEMThqymdUcRGPDA06OIUJFh3I+LFojk4gjkgqx/J7rM3Ce3eKoN+DEa9EjolVgsR4kGIkELfN/KihmnDQUVixLoiOSOLgCaDJQ7la7Uiwx57R0Hq26YViOvlFXlmaSuMFgagXY/mwR5NUysPwotGrilHEYBi8T3BjMwlJiuKvY4FunNbaXCgsT4dY4XFozNHhAUhiHgAYS168U8ZFMQzCU0pEF/gu4ejXKEoXmAa+MNjMEbHDwxsjgZYGFf/h9fJwqlrENXE4ogXE0tw0G07C7HRYfVgpQlIUVePhxlK8ZSO2py6ZAEYZ9L0QFBh96W7P50iigK9cphHap3H5G2FOUlirbhuUyke9hd/Jq1itDOIwsGrS4nxBLSgvKOwABYluPPYltSUK2HDNI9XOKvCRmRwRhUCADszS8pmd4iAyjrDpEIAjENS2Q3DnShmgixvGHaYzneSRtmXmG4c7SyXCnDZsJrM0rjwS5cViMon06OgGkPkvk612YXivYjXsl84DbuxTUeU3QuyhLbC3xcOmqjrKCHSdSvXOAY2GIoh1MgyMW5CAZKz8quvUpPUPD8O4lPkdeatW5NVkjdqLYkXJwFjGKa3JFxfKcPU2aCyl+T5BJxDsXsRtWnakNW5NLh7WaQ1bXKqzU+Bh0FLoTCMhlbrzlPpAZSlFtKCj/ALOVds5I7+Jw25Hu8uvxy4e1q6FpoBnjt6sMOkLaaVWOMqVaucAwjwyi1nqDa8G3YVa81eYOJpp4fFhmHQEYvBTqizCZVo9HE4tgI4IZLExylw4AEeExy8UNzQEBAQEBAQf/2Q==")"
+                     alt="原PO頭像"
+                     style="width: 50px; height: 50px; border-radius: 50%; margin-right: 10px;">
+
                 <span style="font-weight: bold; color: #495057;">@Model.MemberName</span>
             </div>
+
+            
+
+
+
         </div>
 
         <!-- 分類與發佈時間 -->
@@ -27,15 +36,11 @@
             <p style="margin: 0; margin-top: 2px; color: #6c757d;">發佈時間：<strong>@Model.PublishTime.ToString("yyyy-MM-dd HH:mm:ss")</strong></p>
         </div>
 
+        <!-- 貼文圖片 -->
         @if (!string.IsNullOrEmpty(Model.PostImg))
         {
-            <div>
-                @if (!string.IsNullOrEmpty(Model.PostImg))
-                {
-                    <div>
-                        <img src="data:image/png;base64,@Model.PostImg" alt="目前圖片" style="max-width: 100%; height: auto; border-radius: 5px;" />
-                    </div>
-                }
+            <div style="margin-top: 20px;">
+                <img src="data:image/png;base64,@Model.PostImg" alt="貼文圖片" style="max-width: 100%; height: auto; border-radius: 5px;" />
             </div>
         }
 
@@ -49,29 +54,63 @@
             @if (ViewBag.CurrentUserId == Model.MemberId)
             {
                 <button class="btn btn-danger" style="margin-right: 10px;">關閉</button>
-                <button class="btn btn-primary">修改</button>
+                <a class="btn btn-primary" href="@Url.Action("EditPost", "Post", new { id = Model.Id })">修改</a>
             }
         </div>
     </div>
 
     <!-- 留言區塊 -->
-    <div class="comments-section" style="margin-top: 30px; border: 1px solid #ddd; padding: 20px; border-radius: 10px; background-color: #ffffff;">
+    <div class="comments-section" style="margin-top: 30px;">
         <h3 style="border-bottom: 2px solid #28a745; padding-bottom: 5px; color: #28a745;">留言板</h3>
+
         @if (Model.Comments != null && Model.Comments.Any())
         {
             <ul style="list-style: none; padding: 0;">
-                @foreach (var comment in Model.Comments)
+                @foreach (var comment in Model.Comments.OrderBy(c => c.FloorNumber))
                 {
-                    <li style="margin-bottom: 15px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; background-color: #f8f9fa;">
-                        <div style="display: flex; align-items: center;">
-                            <img src="data:image/png;base64,@comment.AuthorImg" alt="留言者頭像" style="width: 30px; height: 30px; border-radius: 50%; margin-right: 10px;">
-                            <strong style="color: #495057;">@comment.AuthorName</strong>
-                            @if (ViewBag.CurrentUserId == comment.AuthorId)
-                            {
-                                <button class="btn btn-danger btn-sm" style="margin-left: auto;">刪除</button>
-                            }
-                        </div>
-                        <p style="margin-left: 40px; margin-top: 10px; color: #212529;">@comment.Content</p>
+                    <li id="floor@(comment.FloorNumber)" style="margin-bottom: 15px; padding: 10px; border: 1px solid #ddd; border-radius: 5px;
+                    background-color: @(ViewBag.DeletedCommentIds != null && ViewBag.DeletedCommentIds.Contains(comment.CommentId) ? "#f8f9fa" : "#fff");
+                    position: relative;">
+
+                        @if (ViewBag.DeletedCommentIds != null && ViewBag.DeletedCommentIds.Contains(comment.CommentId))
+                        {
+                            <!-- 留言已刪除 -->
+                            <p style="color: #6c757d; font-style: italic; text-align: center; margin: 0;">此留言已被刪除。</p>
+                        }
+                        else
+                        {
+                            <!-- 樓層編號與留言資訊 -->
+                            <div style="display: flex; align-items: center;">
+                                <img src="data:image/png;base64,@comment.UserImg" alt="留言者頭像"
+                                     style="width: 30px; height: 30px; border-radius: 50%; margin-right: 10px;">
+                                <strong style="color: #495057;">@comment.UserName</strong>
+                                <span style="margin-left: 10px; color: #007bff; cursor: pointer;"
+                                      onclick="mentionUser('#B@(comment.FloorNumber)')">
+                                    #B@(comment.FloorNumber)
+                                </span>
+                                <span style="margin-left: auto; color: #6c757d; font-size: 0.9em;">
+                                    @comment.CommentTime.ToString("yyyy-MM-dd HH:mm")
+                                </span>
+                            </div>
+
+                            <!-- 留言內容 -->
+                            <p style="margin-left: 40px; margin-top: 10px; color: #212529;">
+                                @Html.Raw(Regex.Replace(comment.Comment, @"(#B\d+)",
+                                "<a href='#floor$1' style='color: #007bff; text-decoration: none;'>$1</a>"))
+                            </p>
+                        }
+
+                        <!-- 刪除留言按鈕 -->
+                        @if (ViewBag.CurrentUserId == Model.MemberId && (ViewBag.DeletedCommentIds == null || !ViewBag.DeletedCommentIds.Contains(comment.CommentId)))
+                        {
+                            <form action="@Url.Action("DeleteComment", "Post")" method="post" style="display: inline;">
+                                <input type="hidden" name="commentId" value="@comment.CommentId" />
+                                <button type="submit" class="btn btn-danger btn-sm"
+                                        style="position: absolute; bottom: 10px; right: 10px;">
+                                    刪除
+                                </button>
+                            </form>
+                        }
                     </li>
                 }
             </ul>
@@ -80,15 +119,86 @@
         {
             <p style="color: #6c757d;">目前沒有留言，快來搶沙發！</p>
         }
+    </div>
+
+
+    <script>
+        function mentionUser(mentionText) {
+            // 獲取留言輸入框
+            const textarea = document.getElementById('commentContent');
+            // 將樓層文字插入到輸入框
+            textarea.value += mentionText;
+            // 聚焦到輸入框
+            textarea.focus();
+        }
+
+        document.addEventListener("DOMContentLoaded", function () {
+            // 平滑滾動功能
+            document.querySelectorAll("a[href^='#floor']").forEach(function (anchor) {
+                anchor.addEventListener("click", function (e) {
+                    e.preventDefault();
+                    const targetId = this.getAttribute("href").substring(1);
+                    const targetElement = document.getElementById(targetId);
+                    if (targetElement) {
+                        targetElement.scrollIntoView({ behavior: "smooth" });
+                    }
+                });
+            });
+        });
+    </script>
+
 
-        <!-- 留言輸入框 -->
-        <div class="add-comment" style="margin-top: 20px; background-color: #f8f9fa; padding: 15px; border-radius: 10px;">
-            <h4 style="color: #17a2b8;">輸入你的留言：</h4>
-            <form method="post" action="/Post/AddComment">
-                <textarea name="Content" class="form-control" rows="3" placeholder="請輸入留言內容" required></textarea>
-                <input type="hidden" name="PostId" value="@Model.Id" />
-                <button type="submit" class="btn btn-success" style="margin-top: 10px;">送出留言</button>
-            </form>
+    <!-- 訊息通知 -->
+    @if (TempData["SuccessMessage"] != null)
+    {
+        <div class="alert alert-success" role="alert">
+            @TempData["SuccessMessage"]
         </div>
-    </div>
+    }
+
+    @if (TempData["ErrorMessage"] != null)
+    {
+        <div class="alert alert-danger" role="alert">
+            @TempData["ErrorMessage"]
+        </div>
+    }
 </div>
+
+<!-- 留言表單 -->
+<div class="add-comment-section" style="margin-top: 20px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; background-color: #f8f9fa;">
+    <form action="@Url.Action("AddCommentAndRefresh", "Post")" method="post">
+        <!-- 傳遞 postId 作為隱藏欄位 -->
+        <input type="hidden" name="postId" value="@Model.Id" />
+
+        <!-- 留言內容 -->
+        <textarea id="commentContent" name="content" class="form-control" rows="3" placeholder="輸入您的留言..." required></textarea>
+
+        <!-- 提交按鈕 -->
+        <button type="submit" class="btn btn-success" style="margin-top: 10px;">送出留言</button>
+    </form>
+</div>
+
+<script>
+    function mentionUser(mentionText) {
+        // 獲取留言輸入框
+        const textarea = document.getElementById('commentContent');
+        // 將文字插入到留言框中
+        textarea.value += mentionText;
+        // 聚焦到輸入框
+        textarea.focus();
+    }
+
+    document.addEventListener("DOMContentLoaded", function () {
+        // 平滑滾動功能
+        document.querySelectorAll("a[href^='#floor']").forEach(function (anchor) {
+            anchor.addEventListener("click", function (e) {
+                e.preventDefault();
+                const targetId = this.getAttribute("href").substring(1);
+                const targetElement = document.getElementById(targetId);
+                if (targetElement) {
+                    targetElement.scrollIntoView({ behavior: "smooth" });
+                }
+            });
+        });
+    });
+</script>
